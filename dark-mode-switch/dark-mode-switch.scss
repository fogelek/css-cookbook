@use "sass:color";

$bg-light: rgb(77, 133, 182);
$bg-dark: #191f2f;
$handle-off: rgb(238, 203, 85);
$handle-on: #ccc;
$handle-craters: #999;
$animation-time: var(--animation-time);
$transition-time: var(--transition-time);

@mixin animate($animation) {
  animation: $animation;
  animation-duration: $animation-time;
}

body {
  transition: $transition-time background-color;

  &.dark {
    background-color: black;
  }
}

.container {
  padding: 0.5em;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  column-gap: 1em;
}

.defs {
  display: none;
}

.switch {
  --animation-time: 1000ms;
  --transition-time: 500ms;

  @media (prefers-reduced-motion) {
    --animation-time: 0;
    --transition-time: 0;
  }

  display: flex;
  cursor: pointer;
  background-color: $bg-light;
  fill: #fff;

  @keyframes switchTurnOn {
    from {
      background-color: $bg-light;
    }
    60% {
      background-color: $bg-dark;
    }
    to {
      background-color: $bg-dark;
    }
  }

  @keyframes switchTurnOff {
    from {
      background-color: $bg-dark;
    }
    60% {
      background-color: $bg-light;
    }
    to {
      background-color: $bg-light;
    }
  }

  .background {
    position: absolute;

    .background-shades {
      transform: translateX(0);

      @keyframes shadesTurnOn {
        from {
          transform: translateX(0);
        }
        50% {
          transform: translateX(10.2em);
        }
        to {
          transform: translateX(10em);
        }
      }

      @keyframes shadesTurnOff {
        from {
          transform: translateX(10em);
        }
        50% {
          transform: translateX(-0.2em);
        }
        to {
          transform: translateX(0);
        }
      }
    }
  }

  &,
  .background,
  .shadow-container {
    width: 10em;
    height: 4em;
    border-radius: 4em;
  }

  .handle {
    display: block;
    width: 3em;
    height: 3em;
    margin: 0.5em;
    border-radius: 50%;
    background-color: $handle-off;
    box-shadow: -1px -3px 2px 0px rgb(0 0 0 /50%) inset,
      1px 2px 2px 1px rgb(255 255 255 /69%) inset;

    @keyframes handleTurnOn {
      from {
        transform: translateX(0);
        background-color: $handle-off;
      }
      50% {
        transform: translateX(6.2em);
        background-color: $handle-on;
      }
      to {
        transform: translateX(6em);
        background-color: $handle-on;
      }
    }

    @keyframes handleTurnOff {
      from {
        transform: translateX(6em);
        background-color: $handle-on;
      }
      50% {
        transform: translateX(-0.2em);
        background-color: $handle-off;
      }
      to {
        transform: translateX(0);
        background-color: $handle-off;
      }
    }
  }

  .clouds {
    .cloud-outer {
      fill: color.adjust($bg-light, $lightness: 40%);
    }
    .cloud-inner {
      fill: color.adjust($bg-light, $lightness: 49%);
    }

    @keyframes cloudsTurnOn {
      from {
        transform: translateY(0);
      }
      50% {
        transform: translateY(5em);
      }
      to {
        transform: translateY(5em);
      }
    }

    @keyframes cloudsTurnOff {
      from {
        transform: translateY(5em);
      }
      50% {
        transform: translateY(-0.2em);
      }
      to {
        transform: translateY(0);
      }
    }
  }

  .craters {
    fill: $handle-craters;
    transition: $transition-time opacity;
  }

  &.on {
    background-color: $bg-dark;

    @include animate(switchTurnOn);

    .handle {
      transform: translateX(6em);
      background-color: $handle-on;

      @include animate(handleTurnOn);
    }

    .background-shades {
      transform: translateX(10em);

      @include animate(shadesTurnOn);
    }

    .clouds {
      transform: translateY(5em);

      @include animate(cloudsTurnOn);
    }
  }

  &.off {
    @include animate(switchTurnOff);

    .handle {
      transform: translateX(0);
      background-color: $handle-off;

      @include animate(handleTurnOff);
    }

    .background-shades {
      @include animate(shadesTurnOff);
    }

    .clouds {
      transform: translateY(0);

      @include animate(cloudsTurnOff);
    }

    .craters {
      opacity: 0;
    }
  }

  .shadow-container {
    display: block;
    position: absolute;
    box-shadow: -4px 4px 5px 0px rgba(0, 0, 0, 0.4) inset,
      3px -3px 5px -1px rgba(0, 0, 0, 0.17) inset;
  }

  &.init {
    &,
    .handle,
    .background-shades,
    .clouds {
      animation-duration: 0ms;
    }
  }
}
